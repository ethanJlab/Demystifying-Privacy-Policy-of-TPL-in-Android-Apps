# coding: utf-8
# Author: kaifa.zhao@connect.polyu.hk
# Copyright 2021@Kaifa Zhao (Zachary)
# Date: 2023/4/27
# System: linux


import os

from Utils import check_macos_files


def main(TPL_list_folder):
    statistics = {}
    for TPL_cat in os.listdir(TPL_list_folder):  # traverse categories of TPLs
        #
        cat_folder = os.path.join(TPL_list_folder, TPL_cat)
        if check_macos_files(TPL_cat) or os.path.isfile(cat_folder):
            continue
        #
        statistics[TPL_cat] = len(os.listdir(cat_folder))
        # if '.DS_Store' in os.listdir(cat_folder):  # exclude Desktop files generated by operation system
        #     statistics[TPL_cat] -= 1
        for i in os.listdir(cat_folder):
            if i.startswith("."):
                statistics[TPL_cat] -= 1
        print(TPL_cat)
        #
        for TPL in os.listdir(cat_folder):
            if TPL.startswith("."):
                continue
            if check_macos_files(TPL):
                continue
            print('\t\"' + TPL + '\",')
    #
    print(' ============================== ')
    TPL_List_num = 0
    for i in statistics:
        TPL_List_num += statistics[i]
        print('The number of TPLs in %s: %d' % (i, statistics[i]))

    print('\nTotal number of TPLs: %d' % TPL_List_num)

    print('Copyright of the list is reserved by AppBrain.')


if __name__ == '__main__':
    TPL_list_path = "../dataset/TPL_PP"
    main(TPL_list_path)
